
/**
* @version 1.0.2
* @package PWebBox
* @copyright © 2013 Majestic Media sp. z o.o., All rights reserved. http://www.perfect-web.co
* @license GNU General Public Licence http://www.gnu.org/licenses/gpl-3.0.html
* @author Piotr Moćko
*
* Mootools 1.2.5
*/
var pwebBoxes=pwebBoxes||[];(function(a){pwebBox=new Class({Implements:[Options,Events],options:{id:"",prefix:"pwebbox",debug:false,openAuto:false,openDelay:0,closeDelay:0,closeOther:true,reposition:true,vertical:false,position:"left",layout:"default",slide:{duration:500,transition:"sine:in:out"},modal:{x:0,y:0,overlayOpacity:0.7,classWindow:"",closable:true,iframe:false,resizeFrom:"top:click"},onTrack:$empty},hidden:true,tracked:false,timer:false,autoOpen:false,autoClose:false,initialize:function(b){this.setOptions(b);this.options.prefix=this.options.prefix+this.options.id;this.Toggler=a(this.options.prefix+"_toggler");if(this.options.layout=="default"){this.horizontal=(!this.options.vertical&&(this.options.position=="left"||this.options.position=="right"));this.Box=a(this.options.prefix+(this.horizontal?"_box":""));this.fx=new Fx.Tween(this.Box,{property:this.options.position,duration:this.options.slide.duration,transition:this.options.slide.transition});this.size=this.Box.getSize();this.position=0-(this.options.position=="left"||this.options.position=="right"?this.size.x:this.size.y);if(this.horizontal){a(this.options.prefix).setStyles({width:0,height:0})}this.Box.setStyle(this.options.position,this.position);if(this.options.reposition&&(this.options.position=="left"||this.options.position=="right")){this.reposition();window.addEvent("resize",function(){this.reposition()}.bind(this))}if(this.options.closeOther){pwebBoxes.push(this)}}else{if(this.options.layout=="modal"){a(this.options.prefix+"_modal_clone").removeProperty("rel")}else{if(this.options.layout=="tab"){this.Toggler.addEvent("click",function(){if(!this.tracked){this.tracked=true;this.fireEvent("onTrack")}}.bind(this))}}}a(this.options.prefix).inject($$("body")[0]);if(this.options.layout!="tab"){$$("."+this.options.prefix+"_toggler").each(function(c){c.addEvent("click",function(d){d.stop();if(this.options.layout=="modal"&&this.options.modal.resizeFrom.indexOf("click")!=-1){SqueezeBox.startPosition=d.page}this.toggleBox()}.bind(this))}.bind(this));if(this.options.openAuto==1){if(this.options.openDelay){this.timer=this.toggleBox.delay(this.options.openDelay,this,1)}else{this.toggleBox(1)}}else{if(this.options.openAuto==2){this.autoOpen=true;window.addEvent("scroll",function(){if(this.autoOpen){this.autoOpen=false;if(this.options.openDelay){this.timer=this.toggleBox.delay(this.options.openDelay,this,1)}else{this.toggleBox(1)}}}.bind(this))}else{if(this.options.openAuto==3){this.autoOpen=-1;document.addEvent("mousemove",function(c){if(this.autoOpen==-1&&c.client.y>70){this.autoOpen=1}else{if(this.autoOpen==1&&c.client.y<30){this.autoOpen=0;if(this.options.openDelay){this.timer=this.toggleBox.delay(this.options.openDelay,this,1)}else{this.toggleBox(1)}}}}.bind(this))}}}if(this.options.closeDelay){this.autoClose=true}}},close:function(){this.toggleBox(0)},toggleBox:function(d){if(typeof d=="undefined"){d=-1}if(this.timer){clearTimeout(this.timer)}if(this.options.layout=="default"){if(this.Toggler){if(!this.hidden&&(d==-1||d==0)){this.Toggler.removeClass("active");this.fx.start(this.position);this.hidden=true}else{if(this.hidden&&(d==-1||d==1)){if(this.options.closeOther){pwebBoxes.each(function(f){if(f.options.id!=this.options.id&&typeof f.close=="function"){f.close()}}.bind(this))}this.Toggler.addClass("active");this.fx.start(0);this.hidden=false;if(!this.tracked){this.tracked=true;this.fireEvent("onTrack")}if(this.autoClose&&this.options.closeDelay){this.autoClose=false;this.timer=this.toggleBox.delay(this.options.closeDelay,this,0)}}}}}else{if(this.options.layout=="modal"){if(!this.hidden&&(d==-1||d==0)){SqueezeBox.close()}else{if(this.hidden&&(d==-1||d==1)){var e=window.getSize();e.y=e.y-80;e.x=e.x-80;var c=this.options.modal.y?(this.options.modal.y>e.y?e.y:this.options.modal.y):e.y;var b=this.options.modal.x?(this.options.modal.x>e.x?e.x:this.options.modal.x):e.x;SqueezeBox.fromElement(a(this.options.prefix+"_modal_clone"),{handler:this.options.modal.iframe?"iframe":"adopt",size:{x:b,y:c},overlayOpacity:this.options.modal.overlayOpacity,classWindow:"pwebBoxWindow "+this.options.prefix+"Window "+this.options.modal.classWindow,closeWithOverlay:this.options.modal.closable,resizeFromTop:this.options.modal.resizeFrom.indexOf("top")!=-1?true:false,onOpen:function(){if(!this.options.modal.iframe){if(this.Toggler){this.Toggler.addClass("active")}a(this.options.prefix+"_container").inject(a("sbox-content")).setStyle("display","block")}this.hidden=false;if(!this.tracked){this.tracked=true;this.fireEvent("onTrack")}if(this.autoClose&&this.options.closeDelay){this.autoClose=false;this.timer=this.toggleBox.delay(this.options.closeDelay,this,0)}}.bind(this),onClose:function(){if(!this.options.modal.iframe){if(this.Toggler){this.Toggler.removeClass("active")}a(this.options.prefix+"_container").setStyle("display","none").inject(a(this.options.prefix))}this.hidden=true}.bind(this)})}}}}},reposition:function(){var c=a(this.options.prefix).getTop();if(c>0){var b=window.getHeight();var d=b-c-this.size.y;if(d<0){d=Math.abs(d);if(d<=c){c-=d}else{c=-10}a(this.options.prefix).setStyle("top",c)}}}})})(document.id);